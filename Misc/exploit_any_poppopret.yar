rule exploit_any_poppopret
{
    meta:
        author = "Jeff White [karttoon@gmail.com] @noottrak"
        date = "11SEP2018"
        description = "Identify POP -> POP -> RET opcodes for quick ROP Gadget creation in target binaries."

    strings:
	    $ = { (07 | 17 | 1F | (58|59|5A|5B|5C|5D|5E|5F) | 8F (00|01|02|03) | 0F A1 | 0F A9) (07 | 17 | 1F | (58|59|5A|5B|5C|5D|5E|5F) | 8F (00|01|02|03) | 0F A1 | 0F A9) (C2| C3) }

    condition:
        all of them
}
