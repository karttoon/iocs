rule apt_win_carbanak_downloader
{
    meta:
        author = "Jeff White (karttoon@gmail.com) @noottrak""
        date = "24FEB2021"
        description = "Detects downloader dropped by TakeOut PowerShell via FIN7 for Carbanak" 
        hash01 = "6d6650fdc451433687232c1ede07070b13dfc325f32b1230a06bb794c726cbe8"
        hash02 = "7ff54bc8fda84f0313b31e212f83ef31ee9d363b431a56fddb828f43491f47ff"
        hash03 = "07590dcc859451e964e28d63b28ab6bdc597e9cf16f4b402a197992ba1881d6f"
        hash04 = "7e23c7467547ebe407ce0abdace169c07d781570f1fd73e860bf9535bd86c6f2"
        hash05 = "261aaf0a90355309d3a3ed08a6cce428fc637ed6a62f3bf6b98ef681d78807c6"
        reference = ""

    strings:
        $rule0_bytes = { 4883EC28488D15A5EA01004183C8FFE8D8BF0000B0014883C428C3CC40534883EC20488BD9E8C2D70000488D051FB00100488D8B8800000033D2488903E87EB50000488BC34883C4205BC3CC40534883EC20488D05F7AF0100488BD94889014881C188000000E815050000488BCB4883C4205BE9E0D700004883EC28E8B7CF000084C07428E87AD6000033C9E823000000F70599EB0100002000007510BA336CD90733C9E8FBCB000033C9FFD033C04883C428C340534881EC50010000E8720C00008BD885C07415EB0AB910270000E804CD0000E8A70100003BD877EDF60550EB010080BB881300007442488D0DDEEF0100E88D3E000084C07423803DCEEF0100000F8435010000B9D0070000E8C6CC000033C9E80B170000E91F0100008BCBE8B3CC00000FBA3507EB010007E85604000084C00F8403010000F705F0EA010000020000741DE87DA8000084C0750DE81418000084C00F85E1000000C6056DEF010000E8C0D9000084C00F84CD000000B101E8ED11000084C0740E830DB2EA0100108BCBE84FCC0000E84A8B0000488D0DEB33000033D2E840CE0000803D2DEF0100007415488D0D7816000033D2C6057BE9010000E822CE0000488D8C24B0000000E855FEFFFF33DB488D8C24B800000033D2E8C033000084C07511B964000000E8F2CB0000FFC383FB327CDC488D4C2420E8B5810000488D4C2420E8438B0000488D4C242033D2E8AFDF0000E8F68A0000E869A60000488D8C24B000000033D2E83EDE0000488D4C2420E8C8810000488D8C24B0000000E80FFEFFFF33C04881C4500100005BC34883EC484D85C0750B488B05B01E02004C8B404848836424300048895424284C894424204533C04533C933D2E83BDC00004883C448C3CCCC4883EC38BA653DBD0D33C9E814CA0000488D4C2420FFD00FB74C24260FB75424200FB7442422C1E2040BC2C1E0050BC10FB74C2428C1E0050BC10FB74C242AC1E0060BC14883C438C3CCCCCC488BC44889580848896810488970184889782041564883EC208B3A33DB4D8BF0488BF2488BE983FF050F8FAE000000747385FF745BFFCF744EFFCF7441FFCF7434FFCF0F85160200008B7A388D4B04E804B300004885C0740C8BD7488BC8E889EA0000EB03488BC3488BC8E860EC0000E9EA010000488D0D38020000EB19488D0D2F020000EB10488D0D26020000EB07488D0DE50100004533C0E815D70000E9BB0100008B7A38B920000000E8A7B200004885C07417448B8EBC0000004C8D463C8BD7488BC8E859E90000EB03488BC3488BC8E8F4E90000E98201000083FF060F8C7901000083FF070F8E5001000083FF080F84F300000083FF09745883FF0A0F8559010000488D0D7FE50100E81ACA0000488B0D6BE50100E8A2B400008B563485D2750948891D58E50100EB10488D4E38E8F5BB000048890546E50100488D0D47E50100891D21E50100E854CB0000E90A010000486342344883F8040F86FC0000008B423C8B7A38890511E5010085C075548B0503E501008BCB488BD385C00F8ED9000000488D35C7E50100393C96740EFFC148FFC23BC87CF2E9BF000000FFC88905D4E401003BC80F8DAF000000488D3C96488D34964883C6042BC18BC8F3A5E99800000048630DAEE4010083F9080F8D88000000488D3576E50100893C8EFFC1890D93E40100EB74899990000000488B157CE40100488DB98800000041B804000000488BCF4881C2500A0000E870B10000488B1559E40100488BCF448B82500A00004569C008010000E853B10000488B074989068B9D90000000EB20448B4238488B0D2AE401004883C23C83FF067507E808E50000EB05E8A1E60000488B6C2438488B742440488B7C24488BC3488B5C24304883C420415EC340534883EC40488BD9488D4C24204183C9FF4533C0BA80000000E87DB70000488D4C2420E84FB80000488B0BE813B300004883C4405BC3CC488B09E904B300004883EC288325A5E30100008325A2E3010000488325AEE3010000E8C1E0000084C07461B9800A0000E86FB000004885C07411488BC8E83EE4000048890577E30100EB084883256DE301000083256EE3010000488D0D77E30100E86AC90000B950000000E834B00000832591E3010000488D0D92E301004889057BE30100E846C90000B0014883C428C3CCCCCC4883EC38488B44246048894424284C894C24204D8BC84C8BC2BA02000000E8E90000004883C438C34883EC38488B44246048894424284C894C24204D8BC84C8BC2BA03000000E8C10000004883C438C34883EC2884C97412488D0D41FAFFFF33D24883C428E95EC9000033C9E82FFAFFFFB0014883C428C340534883EC30F70598E5010000100000740B33C9E80FFAFFFFB001EB4633DB833D4AE40100014C8D0D07E7010048895C24204C8D05B3F9FFFF7510488D159ACA0000488D0D0FCC0000EB0E488D159AC90000488D0D77CC0000E802CD000085C00F95C04883C4305BC3CCCCCC4883EC4833C0458BC84C8BC2488944243048894424288D50014889442420E899D700004883C448C3488BC44889580848896810488970184889782041564883EC40488B5C2470498BF1498BF88BEA4C8BF14885DB750B488B05B3190200488B5848498BC8E8BFBB0000488B5424784C8BC74889542430448D48018BD5498BCE488974242848895C2420E82ED70000488B5C2450488B6C2458488B742460488B7C24684883C440415EC3CCCCCC40534881EC50010000BA8404AA0233C9C744242030010000E8E3C4000033D28D4A02FFD0488BD84883F8FF0F8417010000BAB4C6360F33C9E8C3C40000488D542420488BCBFFD085C00F84E8000000488D4C244CE857BB000083CAFF488BC8E814B900003DC5E2820B775E0F84BF0000003D854CD30877350F84A40000003DC5D07E030F84A00000003D750B81060F849C0000003DA537DA060F84910000003D3524BC07747C3DA5F1CD08EB693D5582E40874413D15E9460974753D05C0AD0974333DA575E40AEB4D3D2524800D772C74233D95D7970B74573D95D7EC0B74503D35C0340C740E3D35EB3F0C743B3D1595570C7523B802000000EB4E3D3581040E74F23D2524BC0E74EB3D4596570F74E43DC5E7C40F7418BA04D0F401E914FFFFFFB803000000EB21B804000000EB1AB801000000EB13BAB57DAE0933C9E8BDC30000488BCBFFD033C04881C4500100005BC3CC40534883EC70834C2420FF4533C9488D542448458D4120488D4C2430E837B40000488D0D38A80100E84B0000004C8D442430488D159FE10100488BC8488BD8E814EB0000488BCBE848AF0000488D4C2430E856F30000488D4C24304885C0488905FBE301000F95C3E85BB400008AC34883C4705BC3CCCCCC488BC4488958084889681048897018488978204154415641574883EC20488BD9E88BB900008BF8B80000000083EF040F48F88D4F01E82EB400004C63FF4C8BD08BC79983E203448D240233D241C1FC02448BF28BCA8BEA8BF2448BDA85FF0F8E8500000085C9751B41FFC64183FE047F0E0FBE2B418BCC83ED6148FFC3EB028BCF85C97E5B480FBE03FFC983F8207D0BBA1F000000448D4AE2EB1B3D800000007D0BBA7F000000448D4AA1EB09BAFF000000448D4A814C8D05B3E40100460FBE0400442BC5453BC17D06412BD14403C247880413FFC6FFCF49FFC348FFC333D24D3BDF0F8C7BFFFFFF488B5C2440488B6C2448488B7C24584863C6488B74245042881410498BC24883C420415F415E415CC3CCCC40534883EC20488BD9488BCAE8DBFEFFFF488903488BC34883C4205BC3CCCCCC4585C90F8E8A00000048895C2408488974241048897C2418458BD88BDA488BF9442BDA418BF141FFC3448B1564E1010033D2418BC20FAF0564E20100030556E101000FB7C88BC141F7F3440FAFD144031543E10100448D0C1333D2410FB7C289053BE2010041F7F34D63C9458A043903D34863CA8A0439418804394488043948FFCE75A5488B5C2408488B742410488B7C2418C340534881EC90010000834C2420FF488BD9488D942488000000488D4C24704533C941B804010000E8ECB10000488D542470B907000000E885E60000834C2420FF4533C9458D4120488D542448488D4C2430E8C2B10000488D4C2430E8C40800004C8D442430488D542470488BCBE862E40000488D4C2430488BD8E809B20000488D4C2470E8FFB10000488BC34881C4900100005BC3CCCCCC48895C2408574883EC40488BDABA04010000488BF9E8CEB400004533C033D2488BCFE88500000084C07472488D4C24204183C9FF4533C0BA80000000E8D3B000004C8D442420488D15B3DE0100488BCBE82BE80000488D0DECA40100E83FFDFFFF488D4C24204183C8FF488BD0488BD8E85FB20000488BCBE83FAC0000448B442428488B542420488BCFE84DE30000488D4C2420E857B10000 } // Autogenerated by BinSequencer

    condition:
        all of them
}
